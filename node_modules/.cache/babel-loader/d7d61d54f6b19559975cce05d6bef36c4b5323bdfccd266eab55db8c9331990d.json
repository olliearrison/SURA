{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { camera } from './Camera.js';\nimport { HistoryController } from \"./HistoryController.js\";\nimport { controls } from './ArcballControl.vue';\nimport * as THREE from 'three';\nclass Frame {\n  constructor() {\n    this.history = new HistoryController();\n    this.scene = new THREE.Scene();\n    this.pos = camera.position.clone();\n    this.angle = camera.rotation.clone();\n  }\n}\nclass FrameController {\n  constructor() {\n    this.frameList = [new Frame()];\n    this.index = 0;\n    this.play = false;\n    this.animationPos = [];\n    this.animationAngle = [];\n    this.animationDetail = 0;\n    this.animationFPS = 100;\n    this.drawingFPS = 5;\n    this.currentPos = new THREE.Vector3();\n    this.currentAngle = new THREE.Euler();\n    this.animationIndex = 0;\n  }\n  updateCamera() {\n    camera.position.copy(this.getFrame().pos);\n    const angle = this.getFrame().angle;\n    camera.rotation.set(angle.x, angle.y, angle.z);\n    camera.updateProjectionMatrix();\n    const frontVector = new THREE.Vector3(0, 0, 4); // Direction in front of the camera\n    const canvasPosition = camera.position.clone().add(camera.getWorldDirection(new THREE.Vector3()).multiplyScalar(frontVector.z));\n    controls.target.copy(canvasPosition);\n    controls.update();\n  }\n  calculateAnimation() {\n    const positions = [];\n    const rotations = [];\n    for (let i = 0; i < this.frameList.length; i++) {\n      const frame = this.getFrameAtIndex(i);\n      positions.push(frame.pos);\n      const v = new THREE.Vector3();\n      v.setFromEuler(frame.angle);\n      rotations.push(v);\n    }\n    console.log(positions, rotations);\n    this.animationDetail = this.animationFPS * this.drawingFPS;\n    const posCurve = new THREE.CatmullRomCurve3(positions);\n    const angleCurve = new THREE.CatmullRomCurve3(rotations);\n    this.animationPos = posCurve.getPoints(this.animationDetail);\n    this.animationAngle = angleCurve.getPoints(this.animationDetail);\n  }\n  updateAnimationFrame() {\n    this.currentPos = this.animationPos[this.animationIndex];\n    this.currentAngle = this.animationAngle[this.animationIndex];\n    if (this.animationIndex % this.animationFPS == 0) {\n      this.setIndex((this.index + 1) % this.frameList.length);\n    }\n    this.animationIndex = (this.animationIndex + 1) % this.animationDetail;\n  }\n  setPos(pos) {\n    this.setPosAtFrame(pos, this.index);\n  }\n  setPosAtFrame(p, i) {\n    this.getFrameAtIndex(i).pos = p;\n  }\n  setAngle(angle) {\n    this.setAngleAtFrame(angle, this.index);\n  }\n  setAngleAtFrame(a, i) {\n    this.getFrameAtIndex(i).angle = a;\n  }\n  addIndex() {\n    this.setIndex(1 + this.index);\n  }\n  subIndex() {\n    this.setIndex(-1 + this.index);\n  }\n  setIndex(v) {\n    this.check(v);\n    this.index = v;\n  }\n  getFrameScene() {\n    return this.getFrame().scene;\n  }\n  getFrame() {\n    return this.getFrameAtIndex(this.index);\n  }\n  getFrameAtIndex(i) {\n    this.check(i);\n    return this.frameList[i];\n  }\n  addFrame() {\n    this.addFrameAtIndex(this.index);\n  }\n  addFrameAtIndex(i) {\n    console.log(i);\n    this.check(i);\n    this.frameList.splice(i + 1, 0, new Frame());\n    this.index++;\n  }\n  delFrame() {\n    this.delFrameAtIndex(this.index);\n  }\n  delFrameAtIndex(i) {\n    this.check(i);\n    if (this.index > 0 && i > 0) {\n      this.frameList.splice(i, 1);\n      this.index--;\n    }\n  }\n  check(i) {\n    if (i < 0 || i >= this.frameList.length) {\n      console.log(\"frame accessed out of bounds\", i);\n    }\n  }\n}\nexport { FrameController };","map":{"version":3,"names":["camera","HistoryController","controls","THREE","Frame","constructor","history","scene","Scene","pos","position","clone","angle","rotation","FrameController","frameList","index","play","animationPos","animationAngle","animationDetail","animationFPS","drawingFPS","currentPos","Vector3","currentAngle","Euler","animationIndex","updateCamera","copy","getFrame","set","x","y","z","updateProjectionMatrix","frontVector","canvasPosition","add","getWorldDirection","multiplyScalar","target","update","calculateAnimation","positions","rotations","i","length","frame","getFrameAtIndex","push","v","setFromEuler","console","log","posCurve","CatmullRomCurve3","angleCurve","getPoints","updateAnimationFrame","setIndex","setPos","setPosAtFrame","p","setAngle","setAngleAtFrame","a","addIndex","subIndex","check","getFrameScene","addFrame","addFrameAtIndex","splice","delFrame","delFrameAtIndex"],"sources":["C:/Users/peopl/Documents/Arduino/6d2/SURA/src/components/FrameController.js"],"sourcesContent":["import { camera } from './Camera.js';\r\nimport { HistoryController } from \"./HistoryController.js\";\r\nimport { controls } from './ArcballControl.vue';\r\nimport * as THREE from 'three';\r\n\r\nclass Frame {\r\n    constructor() {\r\n        this.history = new HistoryController();\r\n        this.scene = new THREE.Scene();\r\n        this.pos = camera.position.clone();\r\n        this.angle = camera.rotation.clone();\r\n    }\r\n\r\n}\r\n\r\nclass FrameController {\r\n    constructor() {\r\n        this.frameList = [new Frame()];\r\n        this.index = 0;\r\n\r\n        this.play = false;\r\n        this.animationPos = [];\r\n        this.animationAngle = [];\r\n        this.animationDetail = 0;\r\n        this.animationFPS = 100;\r\n        this.drawingFPS = 5;\r\n\r\n        this.currentPos = new THREE.Vector3();\r\n        this.currentAngle = new THREE.Euler();\r\n        this.animationIndex = 0;\r\n    }\r\n\r\n    updateCamera(){\r\n        camera.position.copy(this.getFrame().pos);\r\n        const angle = this.getFrame().angle;\r\n        camera.rotation.set(angle.x, angle.y, angle.z);\r\n        camera.updateProjectionMatrix();\r\n\r\n        const frontVector = new THREE.Vector3(0, 0, 4); // Direction in front of the camera\r\n        const canvasPosition = camera.position.clone().add(camera.getWorldDirection(new THREE.Vector3()).multiplyScalar(frontVector.z));\r\n        controls.target.copy(canvasPosition);\r\n\r\n\r\n        controls.update();\r\n    }\r\n\r\n    calculateAnimation(){\r\n        const positions = [];\r\n        const rotations = [];\r\n        for (let i = 0; i < this.frameList.length; i++){\r\n            const frame = this.getFrameAtIndex(i);\r\n            positions.push(frame.pos);\r\n            const v = new THREE.Vector3();\r\n            v.setFromEuler(frame.angle);\r\n            rotations.push(v);\r\n        }\r\n        console.log(positions, rotations);\r\n\r\n        this.animationDetail = this.animationFPS * this.drawingFPS;\r\n\r\n        const posCurve = new THREE.CatmullRomCurve3(positions);\r\n        const angleCurve = new THREE.CatmullRomCurve3(rotations);\r\n        this.animationPos = posCurve.getPoints(this.animationDetail);\r\n        this.animationAngle = angleCurve.getPoints(this.animationDetail);\r\n    }\r\n\r\n    updateAnimationFrame(){\r\n        this.currentPos = this.animationPos[this.animationIndex];\r\n        this.currentAngle = this.animationAngle[this.animationIndex];\r\n        \r\n        if (this.animationIndex % this.animationFPS == 0){\r\n            this.setIndex((this.index + 1) % this.frameList.length);\r\n        }\r\n\r\n        this.animationIndex = (this.animationIndex + 1) % this.animationDetail;\r\n    }\r\n\r\n    setPos(pos){\r\n        this.setPosAtFrame(pos, this.index);\r\n    }\r\n\r\n    setPosAtFrame(p, i){\r\n        this.getFrameAtIndex(i).pos = p;\r\n    }\r\n\r\n    setAngle(angle){\r\n        this.setAngleAtFrame(angle, this.index);\r\n    }\r\n\r\n    setAngleAtFrame(a, i){\r\n        this.getFrameAtIndex(i).angle = a;\r\n    }\r\n\r\n    addIndex(){\r\n        this.setIndex(1 + this.index);\r\n    }\r\n\r\n    subIndex(){\r\n        this.setIndex(-1 + this.index);\r\n    }\r\n\r\n    setIndex(v){\r\n        this.check(v);\r\n        this.index = v;\r\n    }\r\n\r\n    getFrameScene(){\r\n        return this.getFrame().scene;\r\n    }\r\n\r\n    getFrame(){\r\n        return this.getFrameAtIndex(this.index);\r\n    }\r\n\r\n    getFrameAtIndex(i){\r\n        this.check(i);\r\n        return this.frameList[i];\r\n    }\r\n\r\n    addFrame(){\r\n        this.addFrameAtIndex(this.index);\r\n    }\r\n\r\n    addFrameAtIndex(i){\r\n        console.log(i);\r\n        this.check(i);\r\n        this.frameList.splice(i+1, 0, new Frame());\r\n        this.index ++;\r\n\r\n    }\r\n\r\n    delFrame(){\r\n        this.delFrameAtIndex(this.index);\r\n    }\r\n\r\n    delFrameAtIndex(i){\r\n        this.check(i);\r\n        if (this.index > 0 && i > 0){\r\n            this.frameList.splice(i, 1);\r\n            this.index --;\r\n        }\r\n    }\r\n\r\n    check(i){\r\n        if (i < 0 || i >= this.frameList.length){\r\n            console.log(\"frame accessed out of bounds\", i);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport { FrameController }"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}